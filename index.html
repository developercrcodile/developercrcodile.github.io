<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeveloperCrcodiles' Portal</title>
    <style>
        :root {
            --glow-color-normal: #bb86fc;
            --glow-color-win: #03dac6;
            --glow-color-lose: #ff4d4d;
        }

        body { 
            display: flex; 
            flex-direction: column; /* Allow vertical stacking */
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
            background: #121212; 
            font-family: monospace; 
            color: #e0e0e0;
            text-align: center;
            overflow: hidden; /* Hide scrollbars */
        }

        .container {
            position: relative;
            width: 350px;
            height: 450px;
        }

        /* --- Server Styles --- */
        .server-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: opacity 0.5s ease-in-out;
        }
        
        .server-container svg {
            width: 150px;
            height: 150px;
            filter: drop-shadow(0 0 5px var(--glow-color-normal)) 
                    drop-shadow(0 0 15px var(--glow-color-normal));
            transition: filter 0.5s ease-in-out;
        }

        .server-body { fill: #2c2c2e; }
        .server-light { fill: var(--glow-color-normal); transition: fill 0.5s ease-in-out; }

        /* Blinking Animations */
        @keyframes blinking-glow {
            0%, 100% { filter: drop-shadow(0 0 5px) drop-shadow(0 0 15px); }
            50% { filter: drop-shadow(0 0 10px) drop-shadow(0 0 25px); }
        }

        .server-container.animate .server-light {
            animation: blinking-glow 2s infinite ease-in-out;
            animation-play-state: running;
        }
        
        .server-container.server-lose .server-light,
        .server-container.server-lose svg {
            --glow-color-current: var(--glow-color-lose);
            animation-play-state: running !important;
        }

        .server-container .server-light { --glow-color-current: var(--glow-color-normal); }
        .server-container.server-lose .server-light { fill: var(--glow-color-lose); }
        .server-container.animate .server-light { animation-name: blinking-glow; animation-timing-function: ease-in-out; animation-duration: 2s; animation-iteration-count: infinite; }
        .server-container .server-light { animation-play-state: paused; }
        
        /* --- Tic-Tac-Toe Game Styles --- */
        .game-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease-in-out;
        }
        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 100px);
            grid-template-rows: repeat(3, 100px);
            gap: 10px;
            margin: 20px auto;
        }
        .cell {
            width: 100px;
            height: 100px;
            border: 2px solid var(--glow-color-win);
            box-shadow: 0 0 10px var(--glow-color-win);
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4em;
            font-weight: bold;
        }
        .cell.x { color: var(--glow-color-normal); text-shadow: 0 0 10px var(--glow-color-normal); }
        .cell.o { color: var(--glow-color-lose); text-shadow: 0 0 10px var(--glow-color-lose); }
        .status { font-size: 1.5em; height: 30px; color: #a0a0a0; }
        
        /* --- Utility --- */
        .hidden {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- The Server Icon -->
        <div id="server" class="server-container animate">
            <svg viewBox="0 0 24 24">
                <path class="server-body" d="M3 4h18v4H3V4m0 5h18v4H3v-4m0 5h18v4H3v-4z"/>
                <path class="server-light" d="M5 6h2v2H5V6m0 5h2v2H5v-2m0 5h2v2H5v-2z"/>
            </svg>
        </div>

        <!-- The Tic-Tac-Toe Game -->
        <div id="game" class="game-container hidden">
            <h2 class="status">Your Turn (X)</h2>
            <div class="game-board">
                <div class="cell" data-index="0"></div>
                <div class="cell" data-index="1"></div>
                <div class="cell" data-index="2"></div>
                <div class="cell" data-index="3"></div>
                <div class="cell" data-index="4"></div>
                <div class="cell" data-index="5"></div>
                <div class="cell" data-index="6"></div>
                <div class="cell" data-index="7"></div>
                <div class="cell" data-index="8"></div>
            </div>
        </div>
    </div>

<script>
    const serverContainer = document.getElementById('server');
    const gameContainer = document.getElementById('game');
    const statusDisplay = gameContainer.querySelector('.status');
    const cells = gameContainer.querySelectorAll('.cell');

    let board = ['', '', '', '', '', '', '', '', ''];
    let gameActive = false;
    const humanPlayer = 'X';
    const aiPlayer = 'O';

    const winningConditions = [
        [0, 1, 2], [3, 4, 5], [6, 7, 8],
        [0, 3, 6], [1, 4, 7], [2, 5, 8],
        [0, 4, 8], [2, 4, 6]
    ];

    serverContainer.addEventListener('click', startGame);

    function startGame() {
        // Reset server appearance
        serverContainer.classList.remove('server-lose');
        
        // Hide server, show game
        serverContainer.classList.add('hidden');
        gameContainer.classList.remove('hidden');

        // Reset game state
        board = ['', '', '', '', '', '', '', '', ''];
        gameActive = true;
        statusDisplay.textContent = `Your Turn (${humanPlayer})`;
        cells.forEach(cell => {
            cell.textContent = '';
            cell.className = 'cell';
        });
    }

    cells.forEach(cell => {
        cell.addEventListener('click', handleCellClick);
    });

    function handleCellClick(e) {
        const index = e.target.getAttribute('data-index');
        if (board[index] !== '' || !gameActive) {
            return;
        }
        makeMove(index, humanPlayer);

        if (checkWinner(board, humanPlayer)) {
            endGame('win');
            return;
        }
        if (isBoardFull(board)) {
            endGame('draw');
            return;
        }

        // AI's turn
        statusDisplay.textContent = `AI is thinking...`;
        setTimeout(aiMove, 700);
    }

    function aiMove() {
        const bestMove = findBestMove(board);
        makeMove(bestMove, aiPlayer);

        if (checkWinner(board, aiPlayer)) {
            endGame('lose');
            return;
        }
        if (isBoardFull(board)) {
            endGame('draw');
            return;
        }
        statusDisplay.textContent = `Your Turn (${humanPlayer})`;
    }

    function makeMove(index, player) {
        board[index] = player;
        const cell = gameContainer.querySelector(`[data-index='${index}']`);
        cell.textContent = player;
        cell.classList.add(player.toLowerCase());
    }

    function endGame(result) {
        gameActive = false;
        let message = '';
        if (result === 'win') message = 'You Win!';
        else if (result === 'lose') message = 'You Lose!';
        else message = 'It\'s a Draw!';
        statusDisplay.textContent = message;

        if (result === 'lose') {
            serverContainer.classList.add('server-lose');
        }

        setTimeout(() => {
            gameContainer.classList.add('hidden');
            serverContainer.classList.remove('hidden');
        }, 2000); // Wait 2 seconds before showing the server again
    }

    // --- AI Logic (Minimax Algorithm) ---
    function findBestMove(currentBoard) {
        let bestScore = -Infinity;
        let move;
        for (let i = 0; i < 9; i++) {
            if (currentBoard[i] === '') {
                currentBoard[i] = aiPlayer;
                let score = minimax(currentBoard, 0, false);
                currentBoard[i] = ''; // backtrack
                if (score > bestScore) {
                    bestScore = score;
                    move = i;
                }
            }
        }
        return move;
    }

    const scores = { X: -1, O: 1, draw: 0 };

    function minimax(currentBoard, depth, isMaximizing) {
        if (checkWinner(currentBoard, humanPlayer)) return scores.X;
        if (checkWinner(currentBoard, aiPlayer)) return scores.O;
        if (isBoardFull(currentBoard)) return scores.draw;

        if (isMaximizing) {
            let bestScore = -Infinity;
            for (let i = 0; i < 9; i++) {
                if (currentBoard[i] === '') {
                    currentBoard[i] = aiPlayer;
                    let score = minimax(currentBoard, depth + 1, false);
                    currentBoard[i] = '';
                    bestScore = Math.max(score, bestScore);
                }
            }
            return bestScore;
        } else {
            let bestScore = Infinity;
            for (let i = 0; i < 9; i++) {
                if (currentBoard[i] === '') {
                    currentBoard[i] = humanPlayer;
                    let score = minimax(currentBoard, depth + 1, true);
                    currentBoard[i] = '';
                    bestScore = Math.min(score, bestScore);
                }
            }
            return bestScore;
        }
    }

    function checkWinner(currentBoard, player) {
        return winningConditions.some(combination => 
            combination.every(index => currentBoard[index] === player)
        );
    }

    function isBoardFull(currentBoard) {
        return currentBoard.every(cell => cell !== '');
    }

</script>

</body>
</html>
